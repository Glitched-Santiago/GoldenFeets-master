<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{base/base-cliente}">
<head>
    <title>Pedido Confirmado</title>
    <style>
        /* Estilos generales */
        body { background-color: #f3f4f6; }

        .confirmation-container {
            max-width: 800px;
            margin: 3rem auto;
            padding: 0 1rem;
        }

        /* Banner de Éxito */
        .success-banner {
            text-align: center;
            margin-bottom: 2rem;
        }
        .success-icon {
            width: 80px; height: 80px;
            background: #dcfce7;
            color: #166534;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 1.5rem auto;
        }
        .success-title { font-size: 2rem; font-weight: 800; color: #111827; margin-bottom: 0.5rem; }
        .success-subtitle { color: #6b7280; font-size: 1.1rem; }

        /* Estilo Factura */
        .invoice-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }

        .invoice-header {
            background: #111827;
            color: white;
            padding: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .invoice-logo { font-size: 1.5rem; font-weight: 900; letter-spacing: -1px; }
        .invoice-meta { text-align: right; }
        .invoice-number { font-size: 1.2rem; font-weight: 700; color: #fbbf24; }
        .invoice-date { font-size: 0.9rem; opacity: 0.8; margin-top: 4px; }

        .invoice-body { padding: 2.5rem; }

        /* Grid de Direcciones */
        .address-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 2.5rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #f3f4f6;
        }
        .address-col h3 {
            font-size: 0.85rem; text-transform: uppercase; color: #9ca3af;
            font-weight: 700; margin-bottom: 1rem; letter-spacing: 1px;
        }
        .address-box { font-size: 0.95rem; color: #374151; line-height: 1.6; }
        .address-name { font-weight: 700; color: #111827; font-size: 1.1rem; display: block; margin-bottom: 4px; }

        /* Tabla de Productos */
        .invoice-table { width: 100%; border-collapse: collapse; margin-bottom: 2rem; }
        .invoice-table th { text-align: left; color: #6b7280; font-weight: 600; font-size: 0.85rem; padding-bottom: 1rem; border-bottom: 2px solid #f3f4f6; }
        .invoice-table td { padding: 1rem 0; vertical-align: middle; border-bottom: 1px solid #f9fafb; color: #374151; }

        .item-info { display: flex; align-items: center; gap: 1rem; }
        .item-img {
            width: 48px; height: 48px; border-radius: 6px; object-fit: cover;
            border: 1px solid #e5e7eb; mix-blend-mode: multiply;
        }
        .item-desc strong { display: block; color: #111827; font-size: 0.95rem; }
        .item-desc span { font-size: 0.85rem; color: #9ca3af; }

        /* Totales */
        .totals-container { display: flex; justify-content: flex-end; }
        .totals-box { width: 250px; }
        .total-row { display: flex; justify-content: space-between; margin-bottom: 0.8rem; font-size: 0.95rem; color: #6b7280; }
        .total-final {
            border-top: 2px solid #111827;
            padding-top: 1rem;
            margin-top: 1rem;
            font-size: 1.5rem;
            font-weight: 800;
            color: #111827;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Botones de acción */
        .action-buttons {
            display: flex; justify-content: center; gap: 1rem; margin-top: 2.5rem;
        }
        .btn-print {
            background: white; border: 1px solid #d1d5db; color: #374151;
            padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 600; cursor: pointer;
            display: inline-flex; align-items: center; gap: 8px; transition: 0.2s;
        }
        .btn-print:hover { background: #f9fafb; border-color: #9ca3af; }
        .btn-home {
            background: #111827; color: white; border: none;
            padding: 0.75rem 2rem; border-radius: 8px; font-weight: 600; text-decoration: none;
            transition: 0.2s;
        }
        .btn-home:hover { background: #000; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }

        /* ESTILOS PARA IMPRESIÓN */
        @media print {
            body { background: white; }
            nav, footer, .success-banner, .action-buttons, .admin-sidebar { display: none !important; }
            .invoice-card { box-shadow: none; border: none; margin: 0; padding: 0; }
            .confirmation-container { margin: 0; padding: 0; max-width: 100%; }
        }
    </style>
</head>
<body>
<section layout:fragment="content">

    <div class="confirmation-container">

        <div class="success-banner">
            <div class="success-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
            </div>
            <h1 class="success-title">¡Gracias por tu compra!</h1>
            <p class="success-subtitle">Hemos enviado un correo de confirmación a <span th:text="${pedido.cliente.email}" style="font-weight: 600;">email@ejemplo.com</span></p>
        </div>

        <div class="invoice-card">

            <div class="invoice-header">
                <div class="invoice-logo">GOLDENFEETS</div>
                <div class="invoice-meta">
                    <div class="invoice-number" th:text="'ORDEN #' + ${pedido.id}">ORDEN #0000</div>
                    <div class="invoice-date" th:text="${#temporals.format(pedido.fechaCreacion, 'dd/MM/yyyy HH:mm')}">01/01/2025</div>
                </div>
            </div>

            <div class="invoice-body">

                <div class="address-grid">
                    <div class="address-col">
                        <h3>Facturado a</h3>
                        <div class="address-box">
                            <span class="address-name" th:text="${pedido.cliente.nombres} + ' ' + ${pedido.cliente.apellidos}">Nombre Cliente</span>
                            <div th:text="${pedido.cliente.email}">email@cliente.com</div>
                            <div th:text="'Doc: ' + ${pedido.cliente.numeroDocumento}">Doc: 123456</div>
                        </div>
                    </div>
                    <div class="address-col">
                        <h3>Enviado a</h3>
                        <div class="address-box">
                            <span class="address-name" th:text="${pedido.envioNombres} + ' ' + ${pedido.envioApellidos}">Nombre Envío</span>
                            <div th:text="${pedido.envioDireccion}">Dirección 123</div>
                            <div th:text="${pedido.envioCiudad} + ', ' + ${pedido.envioLocalidad}">Ciudad</div>
                            <div th:text="'Tel: ' + ${pedido.envioTelefono}">Tel: 300123456</div>
                        </div>
                    </div>
                </div>

                <table class="invoice-table">
                    <thead>
                    <tr>
                        <th style="width: 50%;">Producto</th>
                        <th style="text-align: center;">Cant.</th>
                        <th style="text-align: right;">Precio</th>
                        <th style="text-align: right;">Total</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="detalle : ${pedido.detalles}">
                        <td>
                            <div class="item-info">
                                <img th:src="${detalle.productoVariante.imagenUrl != null ? detalle.productoVariante.imagenUrl : detalle.producto.imagenUrl}" class="item-img" alt="Prod">
                                <div class="item-desc">
                                    <strong th:text="${detalle.producto.nombre}">Nike Air Force</strong>
                                    <span>
                                            Talla: <span th:text="${detalle.productoVariante.talla}">42</span> |
                                            Color: <span th:text="${detalle.productoVariante.color}">Blanco</span>
                                        </span>
                                </div>
                            </div>
                        </td>
                        <td style="text-align: center;" th:text="${detalle.cantidad}">1</td>
                        <td style="text-align: right;" th:text="'$' + ${#numbers.formatDecimal(detalle.precioUnitario, 0, 'COMMA', 0, 'POINT')}">$100.000</td>
                        <td style="text-align: right; font-weight: 600;" th:text="'$' + ${#numbers.formatDecimal(detalle.subtotal, 0, 'COMMA', 0, 'POINT')}">$100.000</td>
                    </tr>
                    </tbody>
                </table>

                <div class="totals-container">
                    <div class="totals-box">
                        <div class="total-row">
                            <span>Subtotal</span>
                            <span th:text="'$' + ${#numbers.formatDecimal(pedido.total, 0, 'COMMA', 0, 'POINT')}">$100.000</span>
                        </div>
                        <div class="total-row">
                            <span>Envío</span>
                            <span style="color: #16a34a; font-weight: 600;">Gratis</span>
                        </div>
                        <div class="total-final">
                            <span>TOTAL</span>
                            <span th:text="'$' + ${#numbers.formatDecimal(pedido.total, 0, 'COMMA', 0, 'POINT')}">$100.000</span>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <div class="action-buttons">
            <button onclick="window.print()" class="btn-print">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                Imprimir Recibo
            </button>
            <a th:href="@{/catalogo}" class="btn-home">Seguir Comprando</a>
        </div>

    </div>

</section>
</body>
</html>